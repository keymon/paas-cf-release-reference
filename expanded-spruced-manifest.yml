---
instance_groups:
- azs:
  - z1
  - z2
  - z3
  instances: 3
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          mode: server
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-server
    release: datadog-for-cloudfoundry
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  name: consul
  networks:
  - name: cf
    static_ips: ((consul_static_ips))
  persistent_disk_type: consul
  stemcell: default
  update:
    serial: true
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - consumes:
      nats: nil
    name: nats
    release: nats
    properties:
      nats:
        user: nats_user
        password: ((secrets_nats_password))
        port: ((nats_port))
        machines: ((nats_static_ips))
        debug: false
        trace: false
        monitor_port: 0
        prof_port: 0
  - name: datadog-nats
    release: datadog-for-cloudfoundry
    properties:
      nats:
        port: ((nats_port))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  name: nats
  networks:
  - name: cf
    static_ips: ((nats_static_ips))
  stemcell: default
  vm_type: medium
- azs:
  - z1
  - z2
  - z3
  instances: 3
  jobs:
  - consumes:
      consul: nil
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: adapter
    release: cf-syslog-drain
    properties:
      scalablesyslog:
        adapter:
          logs:
            addr: reverse-log-proxy.service.cf.internal:8082
          tls:
            ca: ((certs_bosh_ca_cert))
            cert: ((certs_scalablesyslog_adapter_cert))
            key: ((certs_scalablesyslog_adapter_key))
            cn: scalablesyslog_adapter
        adapter_rlp:
          tls:
            ca: ((certs_bosh_ca_cert))
            cert: ((certs_reverse_log_proxy_cert))
            key: ((certs_reverse_log_proxy_key))
            cn: reverse_log_proxy
  name: adapter
  networks:
  - name: cf
  stemcell: default
  vm_type: small
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: datadog-bbs
    properties:
      bbs:
        ca_cert: /var/vcap/jobs/cfdot/config/certs/cfdot/ca.crt
        client_cert: /var/vcap/jobs/cfdot/config/certs/cfdot/client.crt
        client_key: /var/vcap/jobs/cfdot/config/certs/cfdot/client.key
        url: https://bbs.service.cf.internal:8889/v1/actual_lrp_groups/list
    release: datadog-for-cloudfoundry
  - name: bbs
    release: diego
    properties:
      diego:
        bbs:
          auctioneer:
            api_location: auctioneer.service.cf.internal:9016
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_auctioneer_client_cert))
            client_key: ((certs_auctioneer_client_key))
            require_tls: true
          dropsonde_port: ((dropsonde_incoming_port))
          active_key_label: key-2017-01
          encryption_keys:
          - label: key-2017-01
            passphrase: ((secrets_bbs_encryption_key))
          require_ssl: true
          ca_cert: ((certs_bosh_ca_cert))
          server_cert: ((certs_bbs_server_cert))
          server_key: ((certs_bbs_server_key))
          etcd:
            machines: []
            require_ssl: false
            ca_cert: ''
            client_cert: ''
            client_key: ''
          sql:
            db_host: ((terraform_outputs_cf_db_address))
            db_port: 5432
            db_schema: bbs
            db_username: bbs
            db_password: ((secrets_cf_db_bbs_password))
            db_driver: postgres
          rep:
            require_tls: true
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_rep_client_cert))
            client_key: ((certs_rep_client_key))
  - name: cfdot
    release: diego
    properties:
      diego:
        cfdot:
          bbs:
            use_ssl: true
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  migrated_from:
  - name: database
  name: diego-api
  networks:
  - name: cf
  stemcell: default
  update:
    serial: true
  vm_extensions:
  - cf_rds_client_sg
  vm_type: medium
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          services:
            uaa: {}
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: uaa
    release: uaa
    properties:
      uaadb:
        address: ((terraform_outputs_cf_db_address))
        databases:
        - citext: true
          name: uaa
          tag: uaa
        db_scheme: postgresql
        port: 5432
        roles:
        - name: uaa
          password: ((secrets_cf_db_uaa_password))
          tag: admin
      uaa:
        port: 8080
        url: https://uaa.((system_domain))
        zones:
          internal:
            hostnames:
            - uaa.service.cf.internal
        issuer: https://uaa.((system_domain))
        logging_level: INFO
        require_https: false
        ssl:
          port: 8443
        sslCertificate: ((certs_uaa_internal_cert))
        sslPrivateKey: ((certs_uaa_internal_key))
        clients:
          cc-service-dashboards:
            authorities: clients.read,clients.write,clients.admin
            authorized-grant-types: client_credentials
            override: true
            redirect-uri: https://login.((system_domain))
            secret: ((secrets_uaa_clients_cc_service_dashboards_password))
          cc_routing:
            authorities: routing.router_groups.read
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_cc_routing_secret))
          cc_service_key_client:
            authorities: credhub.read,credhub.write
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_clients_cc_service_key_client_secret))
          cdn_broker:
            authorities: uaa.none
            authorized-grant-types: password
            override: true
            scope: cloud_controller.admin_read_only
            secret: ((secrets_uaa_clients_cdn_broker_secret))
          cf:
            access-token-validity: 600
            authorities: uaa.none
            authorized-grant-types: password,refresh_token
            override: true
            refresh-token-validity: 604800
            scope: cloud_controller.read,cloud_controller.write,openid,password.write,cloud_controller.admin,cloud_controller.admin_read_only,cloud_controller.global_auditor,scim.read,scim.write,scim.invite,doppler.firehose,uaa.user,routing.router_groups.read,routing.router_groups.write
            secret: ''
          cloud_controller_username_lookup:
            authorities: scim.userids
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_clients_cloud_controller_username_lookup_secret))
          doppler:
            authorities: uaa.resource
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_clients_doppler_secret))
          gorouter:
            authorities: routing.routes.read
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_clients_gorouter_secret))
          graphite-nozzle:
            access-token-validity: 1209600
            authorities: oauth.login,doppler.firehose
            authorized-grant-types: authorization_code,client_credentials,refresh_token
            override: true
            redirect-uri: https://login.((system_domain))/login
            scope: openid,oauth.approvals,doppler.firehose
            secret: ((secrets_uaa_clients_firehose_password))
          login:
            authorities: oauth.login,scim.write,clients.read,notifications.write,critical_notifications.write,emails.write,scim.userids,password.write
            authorized-grant-types: authorization_code,client_credentials,refresh_token
            override: true
            redirect-uri: https://login.((system_domain))
            scope: openid,oauth.approvals
            secret: ((secrets_uaa_clients_login_secret))
          notifications:
            authorities: cloud_controller.admin,scim.read
            authorized-grant-types: client_credentials
            override: true
            secret: ((secrets_uaa_clients_notifications_secret))
          paas-admin:
            authorities: uaa.none
            authorized-grant-types: authorization_code,refresh_token
            autoapprove: true
            override: true
            redirect-uri: https://paas-admin.((app_domain))/auth/cloudfoundry/callback
            scope: openid,oauth.approvals,cloud_controller.read,cloud_controller.admin_read_only,cloud_controller.global_auditor
            secret: ((secrets_uaa_clients_paas_admin_secret))
          paas-billing:
            access-token-validity: 1209600
            authorities: cloud_controller.admin_read_only,uaa.resource
            authorized-grant-types: client_credentials,refresh_token,authorization_code
            autoapprove: true
            override: true
            redirect-uri: https://paas-billing.((app_domain))/oauth/callback
            scope: openid,oauth.approvals,cloud_controller.admin_read_only,cloud_controller.read,cloud_controller.global_auditor,cloud_controller.admin
            secret: ((secrets_uaa_clients_paas_billing_secret))
          paas-metrics:
            access-token-validity: 1209600
            authorities: oauth.login,cloud_controller.global_auditor
            authorized-grant-types: client_credentials,refresh_token
            override: true
            redirect-uri: https://login.((system_domain))
            scope: openid,oauth.approvals,cloud_controller.global_auditor
            secret: ((secrets_uaa_clients_paas_metrics_secret))
          ssh-proxy:
            authorized-grant-types: authorization_code
            autoapprove: true
            override: true
            redirect-uri: https://login.((system_domain))/login
            scope: openid,cloud_controller.read,cloud_controller.write,cloud_controller.admin
            secret: ((secrets_uaa_clients_ssh_proxy_secret))
          tcp_emitter:
            authorities: routing.routes.write,routing.routes.read
            authorized-grant-types: client_credentials
            override: true
            secret: ''
          tcp_router:
            authorities: routing.routes.read
            authorized-grant-types: client_credentials
            override: true
            secret: ''
          user_invitation:
            authorities: oauth.login,scim.write,emails.write,scim.userids
            authorized-grant-types: password,refresh_token
            override: true
            redirect-uri: https://www.cloud.service.gov.uk/next-steps?success
            scope: openid,password.write,scim.read,scim.write,scim.invite,uaa.user
            secret: ((secrets_uaa_clients_login_secret))
        admin:
          client_secret: ((secrets_uaa_admin_client_secret))
        password:
          policy:
            minLength: 8
        jwt:
          policy:
            refreshTokenValiditySeconds: 604800
            active_key_id: default
            keys:
              default:
                signingKey: ((certs_uaa_jwt_signing_key))
              previous:
                signingKey: ((certs_uaa_jwt_signing_old_key))
            global:
              refreshTokenValiditySeconds: 604800
        scim:
          userids_enabled: true
          users:
          - groups:
            - scim.write
            - scim.read
            - scim.invite
            - openid
            - cloud_controller.admin
            - cloud_controller.admin_read_only
            - doppler.firehose
            name: admin
            password: ((secrets_uaa_admin_password))
          groups:
            cloud_controller.global_auditor: Global Auditor read only group
      login:
        branding:
          company_name: GOV.UK PaaS
        asset_base_url: https://paas-uaa-assets.((terraform_outputs_cf_apps_domain))
        links:
          homeRedirect: https://www.cloud.service.gov.uk/next-steps?account-updated
          passwd: https://login.((system_domain))/forgot_password
          signup: https://www.cloud.service.gov.uk/signup
        self_service_links_enabled: true
        smtp:
          auth: true
          from_address: gov-uk-paas-support@digital.cabinet-office.gov.uk
          host: ((terraform_outputs_ses_smtp_host))
          password: ((terraform_outputs_ses_smtp_password))
          port: 587
          starttls: true
          user: ((terraform_outputs_ses_smtp_aws_access_key_id))
        saml:
          activeKeyId: key1
          keys:
            key1:
              certificate: ((certs_saml_cert))
              key: ((certs_saml_key))
              passphrase: ''
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: statsd_injector
    release: statsd-injector
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          statsd_injector:
            cert: ((certs_statsd_injector_cert))
            key: ((certs_statsd_injector_key))
  - name: route_registrar
    release: routing
    properties:
      nats:
        machines: ((nats_static_ips))
        port: ((nats_port))
        user: nats_user
        password: ((secrets_nats_password))
      route_registrar:
        routes:
        - health_check:
            name: cf_uaa_health_check
            script_path: /var/vcap/jobs/uaa/bin/health_check
            timeout: 5s
          name: uaa
          port: 8081
          registration_interval: 10s
          server_cert_domain_san: uaa.service.cf.internal
          tags:
            component: uaa
          tls_port: 8443
          uris:
          - uaa.((system_domain))
          - login.((system_domain))
  name: uaa
  networks:
  - name: cf
  stemcell: default
  vm_extensions:
  - cf_rds_client_sg
  vm_type: medium
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          services:
            cloud_controller_ng: {}
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - consumes:
      nats: nil
    name: cloud_controller_ng
    release: capi
    properties:
      ssl:
        skip_cert_verify: false
      system_domain: ((terraform_outputs_cf_root_domain))
      system_domain_organization: admin
      app_domains:
      - ((terraform_outputs_cf_apps_domain))
      app_ssh:
        host_key_fingerprint: ((secrets_ssh_proxy_host_key.public_fingerprint))
      request_timeout_in_seconds: 900
      support_address: https://docs.cloud.service.gov.uk
      description: 
      cc:
        external_port: 9022
        tls_port: 9023
        internal_service_hostname: cloud-controller-ng.service.cf.internal
        jobs:
          global:
            timeout_in_seconds: 14400
          blobstore_delete:
            timeout_in_seconds: 
          droplet_upload:
            timeout_in_seconds: 
        directories: 
        external_protocol: 
        external_host: api
        bulk_api_password: ((secrets_bulk_api_password))
        internal_api_user: internal_user
        internal_api_password: ((secrets_bulk_api_password))
        min_cli_version: 
        min_recommended_cli_version: 
        logging_level: info
        db_logging_level: debug
        default_health_check_timeout: 60
        maximum_health_check_timeout: 180
        stacks: 
        staging_upload_user: staging_upload_user
        staging_upload_password: ((secrets_staging_upload_password))
        quota_definitions:
          2xlarge:
            memory_limit: 409600
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 160
          default:
            memory_limit: 5120
            non_basic_services_allowed: false
            total_routes: 1000
            total_services: 10
          large:
            memory_limit: 102400
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 40
          medium:
            memory_limit: 61440
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 20
          small:
            memory_limit: 10240
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 10
          test_apps:
            memory_limit: 2048
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 10
          xlarge:
            memory_limit: 204800
            non_basic_services_allowed: true
            total_routes: 1000
            total_services: 80
        default_quota_definition: default
        resource_pool:
          resource_directory_key: ((environment))-cf-resources
          fog_connection: &9684740
            provider: AWS
            region: ((terraform_outputs_region))
            use_iam_profile: true
          cdn: 
        packages:
          app_package_directory_key: ((environment))-cf-packages
          max_package_size: 1073741824
          max_valid_packages_stored: 
          fog_connection: &9718520
            provider: AWS
            region: ((terraform_outputs_region))
            use_iam_profile: true
          cdn: 
        droplets:
          droplet_directory_key: ((environment))-cf-droplets
          max_staged_droplets_stored: 
          fog_connection: &9764300
            provider: AWS
            region: ((terraform_outputs_region))
            use_iam_profile: true
          cdn: 
        buildpacks:
          buildpack_directory_key: ((environment))-cf-buildpacks
          fog_connection: &9803860
            provider: AWS
            region: ((terraform_outputs_region))
            use_iam_profile: true
          cdn: 
        db_encryption_key: ((secrets_cc_db_encryption_key))
        default_app_memory: 1024
        default_app_disk_in_mb: 1024
        maximum_app_disk_in_mb: 2048
        allow_app_ssh_access: true
        client_max_body_size: 15M
        disable_custom_buildpacks: false
        broker_client_timeout_seconds: 70
        broker_client_default_async_poll_interval_seconds: 
        broker_client_max_async_poll_duration_minutes: 11520
        development_mode: false
        newrelic:
          license_key: 
          environment_name: ((environment))
          developer_mode: false
          monitor_mode: false
          capture_params: false
          transaction_tracer:
            enabled: true
            record_sql: obfuscated
        thresholds:
          api:
            alert_if_above_mb: 
            restart_if_consistently_above_mb: 
            restart_if_above_mb: 
        install_buildpacks:
        - name: staticfile_buildpack
          package: staticfile-buildpack
        - name: java_buildpack
          package: java-buildpack
        - name: ruby_buildpack
          package: ruby-buildpack
        - name: nodejs_buildpack
          package: nodejs-buildpack
        - name: go_buildpack
          package: go-buildpack
        - name: python_buildpack
          package: python-buildpack
        - name: php_buildpack
          package: php-buildpack
        - name: binary_buildpack
          package: binary-buildpack
        security_group_definitions:
        - name: public_networks
          rules:
          - destination: 0.0.0.0-9.255.255.255
            protocol: all
          - destination: 11.0.0.0-169.253.255.255
            protocol: all
          - destination: 169.255.0.0-172.15.255.255
            protocol: all
          - destination: 172.32.0.0-192.167.255.255
            protocol: all
          - destination: 192.169.0.0-255.255.255.255
            protocol: all
        - name: dns
          rules:
          - destination: 0.0.0.0/0
            ports: '53'
            protocol: tcp
          - destination: 0.0.0.0/0
            ports: '53'
            protocol: udp
        - name: rds_broker_instances
          rules:
          - destination: ((terraform_outputs_aws_backing_service_cidr_all))
            ports: '5432'
            protocol: tcp
          - destination: ((terraform_outputs_aws_backing_service_cidr_all))
            ports: '3306'
            protocol: tcp
        - name: elasticache_broker_instances
          rules:
          - destination: ((terraform_outputs_aws_backing_service_cidr_all))
            ports: '6379'
            protocol: tcp
        default_running_security_groups:
        - public_networks
        - dns
        - rds_broker_instances
        - elasticache_broker_instances
        default_staging_security_groups:
        - public_networks
        - dns
        - rds_broker_instances
        - elasticache_broker_instances
        allowed_cors_domains: []
        mutual_tls:
          ca_cert: ((certs_bosh_ca_cert))
          public_cert: ((certs_cc_server_cert))
          private_key: ((certs_cc_server_key))
      ccdb:
        databases: &9555720
        - citext: true
          name: api
          tag: cc
        roles: &9554520
        - name: api
          password: ((secrets_cf_db_api_password))
          tag: admin
        db_scheme: postgres
        address: ((terraform_outputs_cf_db_address))
        port: 5432
      uaa:
        url: https://uaa.((system_domain))
        ca_cert: ((certs_bosh_ca_cert))
        ssl:
          port: 8443
        port: 8080
        clients:
          cc-service-dashboards:
            secret: ((secrets_uaa_clients_cc_service_dashboards_password))
          cloud_controller_username_lookup:
            secret: ((secrets_uaa_clients_cloud_controller_username_lookup_secret))
          cc_service_key_client:
            secret: ((secrets_uaa_clients_cc_service_key_client_secret))
          cc_routing:
            secret: ((secrets_uaa_cc_routing_secret))
      login:
        enabled: true
      doppler:
        port: 443
      router:
        route_services_secret: ((secrets_route_services_secret))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: statsd_injector
    release: statsd-injector
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          statsd_injector:
            cert: ((certs_statsd_injector_cert))
            key: ((certs_statsd_injector_key))
  - name: file_server
    release: diego
    properties:
      diego:
        file_server:
          dropsonde_port: ((dropsonde_incoming_port))
  - name: cc_uploader
    release: capi
    properties:
      capi:
        cc_uploader:
          dropsonde_port: ((dropsonde_incoming_port))
          cc:
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_cc_client_cert))
            client_key: ((certs_cc_client_key))
          mutual_tls:
            ca_cert: ((certs_bosh_ca_cert))
            server_cert: ((certs_cc_uploader_server_cert))
            server_key: ((certs_cc_uploader_server_key))
  - name: java-buildpack
    release: java-buildpack
  - name: go-buildpack
    release: go-buildpack
  - name: binary-buildpack
    release: binary-buildpack
  - name: nodejs-buildpack
    release: nodejs-buildpack
  - name: ruby-buildpack
    release: ruby-buildpack
  - name: php-buildpack
    release: php-buildpack
  - name: python-buildpack
    release: python-buildpack
  - name: staticfile-buildpack
    release: staticfile-buildpack
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: datadog-cc
    release: datadog-for-cloudfoundry
    properties:
      cc:
        external_port: 9022
  name: api
  networks:
  - name: cf
  stemcell: default
  vm_extensions:
  - 64g_ephemeral_disk
  - cf_cc_instance_profile
  - cf_cc_security_groups
  - cf_cc_elb
  vm_type: large
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - consumes:
      nats: nil
    name: cloud_controller_worker
    release: capi
    properties:
      ssl:
        skip_cert_verify: false
      system_domain: ((terraform_outputs_cf_root_domain))
      cc:
        external_port: 9022
        tls_port: 9023
        internal_service_hostname: cloud-controller-ng.service.cf.internal
        jobs:
          global:
            timeout_in_seconds: 14400
          blobstore_delete:
            timeout_in_seconds: 
          generic:
            number_of_workers: 
        external_protocol: 
        external_host: api
        internal_api_user: internal_user
        internal_api_password: ((secrets_bulk_api_password))
        logging_level: info
        db_logging_level: debug
        default_health_check_timeout: 60
        stacks: 
        staging_upload_user: staging_upload_user
        staging_upload_password: ((secrets_staging_upload_password))
        resource_pool:
          resource_directory_key: ((environment))-cf-resources
          fog_connection: *9684740
          cdn: 
        packages:
          app_package_directory_key: ((environment))-cf-packages
          max_package_size: 1073741824
          fog_connection: *9718520
          cdn: 
        droplets:
          droplet_directory_key: ((environment))-cf-droplets
          fog_connection: *9764300
          cdn: 
        buildpacks:
          buildpack_directory_key: ((environment))-cf-buildpacks
          fog_connection: *9803860
          cdn: 
        db_encryption_key: ((secrets_cc_db_encryption_key))
        default_app_memory: 1024
        default_app_disk_in_mb: 1024
        maximum_app_disk_in_mb: 2048
        allow_app_ssh_access: true
        broker_client_timeout_seconds: 70
        development_mode: false
        newrelic:
          license_key: 
          environment_name: ((environment))
          developer_mode: false
          monitor_mode: false
          capture_params: false
          transaction_tracer:
            enabled: true
            record_sql: obfuscated
        thresholds:
          worker:
            alert_if_above_mb: 
            restart_if_consistently_above_mb: 
            restart_if_above_mb: 
        broker_client_default_async_poll_interval_seconds: 
        broker_client_max_async_poll_duration_minutes: 11520
        mutual_tls:
          ca_cert: ((certs_bosh_ca_cert))
          public_cert: ((certs_cc_server_cert))
          private_key: ((certs_cc_server_key))
      ccdb:
        databases: *9555720
        roles: *9554520
        db_scheme: postgres
        address: ((terraform_outputs_cf_db_address))
        port: 5432
      uaa:
        ssl:
          port: 8443
        port: 8080
        ca_cert: ((certs_bosh_ca_cert))
        clients:
          cc-service-dashboards:
            secret: ((secrets_uaa_clients_cc_service_dashboards_password))
          cc_routing:
            secret: ((secrets_uaa_cc_routing_secret))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: datadog-cc-worker
    release: datadog-for-cloudfoundry
    properties:
      cc:
        jobs:
          generic:
            number_of_workers: 
  migrated_from:
  - name: api_worker
  name: cc-worker
  networks:
  - name: cf
  stemcell: default
  vm_extensions:
  - 64g_ephemeral_disk
  - cf_cc_instance_profile
  - cf_cc_security_groups
  vm_type: medium
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          services:
            gorouter: {}
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - consumes:
      nats: nil
    name: gorouter
    release: routing
    properties:
      router:
        status:
          port: 8080
          user: router_user
          password: ((secrets_router_password))
        drain_wait: 120
        enable_ssl: false
        backends:
          cert_chain: ((certs_router_internal_cert))
          private_key: ((certs_router_internal_key))
          enable_tls: true
        route_services_secret: ((secrets_route_services_secret))
        max_idle_connections: 0
        tracing:
          enable_zipkin: true
        enable_access_log_streaming: true
      nats:
        user: nats_user
        password: ((secrets_nats_password))
        port: ((nats_port))
        machines: ((nats_static_ips))
      request_timeout_in_seconds: 900
      uaa:
        clients:
          gorouter:
            secret: ((secrets_uaa_clients_gorouter_secret))
        ssl:
          port: 8443
        ca_cert: ((certs_bosh_ca_cert))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: haproxy
    release: paas-haproxy
    properties:
      ha_proxy:
        ssl_pem: ((certs_router_internal_cert))((certs_router_internal_key))
        disable_http: true
        enable_proxy_protocol: true
        go_router:
          servers:
          - 127.0.0.1
          port: 80
          healthcheck_port: 8080
        additional_frontend_config: ! 'capture response header strict-transport-security
          len 128

          http-response add-header Strict-Transport-Security max-age=31536000;\ includeSubDomains;\
          preload unless { capture.res.hdr(0) -m found }

'
        enable_healthcheck_frontend: true
        enable_http_redirect_frontend: true
      request_timeout_in_seconds: 900
  - name: datadog-router
    release: datadog-for-cloudfoundry
  - name: racoon
    release: ipsec
    properties:
      racoon:
        ports:
        - name: router
          targets: ((terraform_outputs_cell_subnet_cidr_blocks))
        certificate_authority_private_key: ((certs_ipsec_ca_key))
        certificate_authority_cert: ((certs_ipsec_ca_cert))
        level: require
        verify_certificate: 'on'
  - name: datadog-ipsec
    release: datadog-for-cloudfoundry
  name: router
  networks:
  - name: router
  stemcell: default
  update:
    serial: true
  vm_type: router
- azs:
  - z1
  - z2
  - z3
  instances: 3
  jobs:
  - consumes:
      consul: nil
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: cfdot
    release: diego
    properties:
      diego:
        cfdot:
          bbs:
            use_ssl: true
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
  - name: auctioneer
    release: diego
    properties:
      diego:
        auctioneer:
          ca_cert: ((certs_bosh_ca_cert))
          server_cert: ((certs_auctioneer_server_cert))
          server_key: ((certs_auctioneer_server_key))
          dropsonde_port: ((dropsonde_incoming_port))
          bbs:
            api_location: bbs.service.cf.internal:8889
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
            require_ssl: true
          rep:
            require_tls: true
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_rep_client_cert))
            client_key: ((certs_rep_client_key))
  - name: cloud_controller_clock
    release: capi
    properties:
      ssl:
        skip_cert_verify: false
      system_domain: ((terraform_outputs_cf_root_domain))
      cc:
        external_port: 9022
        tls_port: 9023
        internal_service_hostname: cloud-controller-ng.service.cf.internal
        jobs:
          global:
            timeout_in_seconds: 14400
          app_usage_events_cleanup:
            timeout_in_seconds: 
          blobstore_delete:
            timeout_in_seconds: 
        app_usage_events:
          cutoff_age_in_days: 45
        service_usage_events:
          cutoff_age_in_days: 45
        audit_events:
          cutoff_age_in_days: 31
        external_protocol: 
        external_host: api
        internal_api_user: internal_user
        internal_api_password: ((secrets_bulk_api_password))
        logging_level: info
        db_logging_level: debug
        default_health_check_timeout: 60
        stacks: 
        staging_upload_user: staging_upload_user
        staging_upload_password: ((secrets_staging_upload_password))
        resource_pool:
          resource_directory_key: ((environment))-cf-resources
          fog_connection: *9684740
          cdn: 
        packages:
          app_package_directory_key: ((environment))-cf-packages
          max_package_size: 1073741824
          fog_connection: *9718520
          cdn: 
        droplets:
          droplet_directory_key: ((environment))-cf-droplets
          fog_connection: *9764300
          cdn: 
        buildpacks:
          buildpack_directory_key: ((environment))-cf-buildpacks
          fog_connection: *9803860
          cdn: 
        allow_app_ssh_access: true
        db_encryption_key: ((secrets_cc_db_encryption_key))
        default_app_memory: 1024
        default_app_disk_in_mb: 1024
        maximum_app_disk_in_mb: 2048
        newrelic:
          license_key: 
          environment_name: ((environment))
          developer_mode: false
          monitor_mode: false
          capture_params: false
          transaction_tracer:
            enabled: true
            record_sql: obfuscated
        thresholds:
          api:
            alert_if_above_mb: 
            restart_if_consistently_above_mb: 
            restart_if_above_mb: 
        mutual_tls:
          ca_cert: ((certs_bosh_ca_cert))
          public_cert: ((certs_cc_server_cert))
          private_key: ((certs_cc_server_key))
      ccdb:
        databases: *9555720
        roles: *9554520
        db_scheme: postgres
        address: ((terraform_outputs_cf_db_address))
        port: 5432
      uaa:
        ca_cert: ((certs_bosh_ca_cert))
        ssl:
          port: 8443
        port: 8080
        clients:
          cc-service-dashboards:
            secret: ((secrets_uaa_clients_cc_service_dashboards_password))
          cc_routing:
            secret: ((secrets_uaa_cc_routing_secret))
  - name: statsd_injector
    release: statsd-injector
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          statsd_injector:
            cert: ((certs_statsd_injector_cert))
            key: ((certs_statsd_injector_key))
  - name: tps
    release: capi
    properties:
      diego:
        ssl:
          skip_cert_verify: false
      capi:
        tps:
          dropsonde_port: ((dropsonde_incoming_port))
          traffic_controller_url: wss://doppler.((system_domain)):443
          bbs:
            api_location: bbs.service.cf.internal:8889
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
            require_ssl: true
          cc:
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_cc_client_cert))
            client_key: ((certs_cc_client_key))
          listener_enabled: false
  - name: ssh_proxy
    release: diego
    properties:
      diego:
        ssl:
          skip_cert_verify: false
        ssh_proxy:
          bbs:
            api_location: bbs.service.cf.internal:8889
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
            require_ssl: true
          host_key: ((secrets_ssh_proxy_host_key.private_key))
          dropsonde_port: ((dropsonde_incoming_port))
          enable_cf_auth: true
          enable_diego_auth: false
          diego_credentials: ''
          uaa_token_url: https://uaa.((system_domain))/oauth/token
          uaa_secret: ((secrets_uaa_clients_ssh_proxy_secret))
  - name: scheduler
    release: cf-syslog-drain
    properties:
      scalablesyslog:
        scheduler:
          tls:
            client:
              ca: ((certs_bosh_ca_cert))
              cert: ((certs_scalablesyslog_adapter_scheduler_client_cert))
              key: ((certs_scalablesyslog_adapter_scheduler_client_key))
              adapter_cn: scalablesyslog_adapter
            api:
              ca: ((certs_bosh_ca_cert))
              cert: ((certs_scalablesyslog_adapter_scheduler_api_cert))
              key: ((certs_scalablesyslog_adapter_scheduler_api_key))
              cn: cloud-controller-ng.service.cf.internal
          api:
            url: https://cloud-controller-ng.service.cf.internal:9023
  name: scheduler
  networks:
  - name: cf
  stemcell: default
  update:
    serial: true
  vm_extensions:
  - ssh_proxy_elb
  - cf_rds_client_sg
  vm_type: medium
- azs:
  - z1
  - z2
  - z3
  instances: 3
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          services:
            doppler: {}
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: doppler
    provides:
      doppler:
        as: doppler
    release: loggregator
    properties:
      doppler:
        maxRetainedLogMessages: 100
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          doppler:
            cert: ((certs_doppler_cert))
            key: ((certs_doppler_key))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  name: doppler
  networks:
  - name: cf
  stemcell: default
  vm_type: medium
- azs:
  - z1
  - z2
  - z3
  instances: ((cell_instances))
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - name: rep
    release: diego
    properties:
      diego:
        rep:
          preloaded_rootfses:
          - cflinuxfs2:/var/vcap/packages/cflinuxfs2/rootfs.tar
          dropsonde_port: ((dropsonde_incoming_port))
          enable_legacy_api_endpoints: false
          require_tls: true
          ca_cert: ((certs_bosh_ca_cert))
          server_cert: ((certs_rep_server_cert))
          server_key: ((certs_rep_server_key))
          bbs:
            api_location: bbs.service.cf.internal:8889
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
            require_ssl: true
        ssl:
          skip_cert_verify: false
        executor:
          memory_capacity_mb: ((cell_memory_capacity_mb))
      tls:
        cert: ((certs_cc_client_cert))
        key: ((certs_cc_client_key))
        ca_cert: ((certs_bosh_ca_cert))
  - name: garden
    release: garden-runc
    properties:
      garden:
        deny_networks:
        - 0.0.0.0/0
        log_level: error
        cleanup_process_dirs_on_wait: true
  - name: cflinuxfs2-rootfs-setup
    release: cflinuxfs2
    properties:
      cflinuxfs2-rootfs:
        trusted_certs: ((aws_rds_combined_ca_bundle))
  - name: cfdot
    release: diego
    properties:
      diego:
        cfdot:
          bbs:
            use_ssl: true
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: route_emitter
    properties:
      diego:
        route_emitter:
          bbs:
            api_location: bbs.service.cf.internal:8889
            ca_cert: ((certs_bosh_ca_cert))
            client_cert: ((certs_bbs_client_cert))
            client_key: ((certs_bbs_client_key))
            require_ssl: true
          dropsonde_port: ((dropsonde_incoming_port))
          local_mode: true
          nats:
            machines: ((nats_static_ips))
            password: ((secrets_nats_password))
            port: ((nats_port))
            user: nats_user
    release: diego
  - name: datadog-route-emitter
    release: datadog-for-cloudfoundry
  - name: datadog-rep
    release: datadog-for-cloudfoundry
  - name: datadog-garden
    release: datadog-for-cloudfoundry
  - name: racoon
    release: ipsec
    properties:
      racoon:
        ports:
        - name: cell
          targets: ((terraform_outputs_router_subnet_cidr_blocks))
        certificate_authority_private_key: ((certs_ipsec_ca_key))
        certificate_authority_cert: ((certs_ipsec_ca_cert))
        level: require
        verify_certificate: 'on'
  - name: datadog-ipsec
    release: datadog-for-cloudfoundry
  migrated_from:
  - name: cell
  name: diego-cell
  networks:
  - name: cell
  stemcell: default
  vm_type: cell
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - consumes:
      consul_client: nil
      consul_common: nil
      consul_server: nil
    name: consul_agent
    release: consul
    properties:
      consul:
        agent:
          servers:
            lan: ((consul_static_ips))
          log_level: 
          services:
            loggregator_trafficcontroller: {}
            reverse_log_proxy: {}
          dns_config:
            allow_stale: true
            max_stale: 30s
          domain: cf.internal
        ca_cert: ((certs_bosh_ca_cert))
        server_cert: ((certs_consul_server_cert))
        server_key: ((certs_consul_server_key))
        agent_cert: ((certs_consul_agent_cert))
        agent_key: ((certs_consul_agent_key))
        encrypt_keys: ((secrets_consul_encrypt_keys))
  - name: datadog-consul-agent-client
    release: datadog-for-cloudfoundry
  - consumes:
      doppler:
        from: doppler
    name: loggregator_trafficcontroller
    release: loggregator
    properties:
      loggregator:
        outgoing_dropsonde_port: 8081
        uaa:
          client_secret: ((secrets_uaa_clients_doppler_secret))
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          trafficcontroller:
            cert: ((certs_trafficcontroller_cert))
            key: ((certs_trafficcontroller_key))
          cc_trafficcontroller:
            cert: ((certs_cc_trafficcontroller_cert))
            key: ((certs_cc_trafficcontroller_key))
      uaa:
        internal_url: https://uaa.service.cf.internal:8443
        ca_cert: ((certs_bosh_ca_cert))
      doppler:
        outgoing_port: 8081
      system_domain: ((terraform_outputs_cf_root_domain))
      ssl:
        skip_cert_verify: false
      cc:
        internal_service_hostname: cloud-controller-ng.service.cf.internal
        tls_port: 9023
        mutual_tls:
          ca_cert: ((certs_bosh_ca_cert))
  - name: metron_agent
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          metron:
            cert: ((certs_metron_cert))
            key: ((certs_metron_key))
      metron_agent:
        deployment: ((environment))
  - name: reverse_log_proxy
    release: loggregator
    properties:
      loggregator:
        tls:
          ca_cert: ((certs_bosh_ca_cert))
          reverse_log_proxy:
            cert: ((certs_reverse_log_proxy_cert))
            key: ((certs_reverse_log_proxy_key))
  migrated_from:
  - name: loggregator_trafficcontroller
  name: log-api
  networks:
  - name: cf
  provides:
    reverse_log_proxy:
      as: reverse_log_proxy
      shared: true
  stemcell: default
  update:
    serial: true
  vm_extensions:
  - cf_doppler_elbs
  vm_type: medium
- azs:
  - z1
  instances: 1
  jobs:
  - name: carbon
    release: graphite
    properties:
      carbon:
        cache:
          max_creates_per_minute: 500
        storage_schemas:
        - name: catch_all
          pattern: ^.*$
          retentions: 10s:1d,1m:7d,15m:30d,1h:1y,1d:5y
        storage_aggregations:
        - aggregationMethod: average
          name: catch_all
          pattern: ^.*$
          xFilesFactor: '0.5'
        prune_delay: 10
        filter:
          enable: true
          blacklist:
          - stats\.counters\.cfstats\.router_.+\.[0-9]+\.http\..+\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}.*
  - name: graphite-web
    release: graphite
    properties:
      graphite-web:
        time_zone: Europe/London
        httpd:
          port: 3001
        wsgi:
          inactivity-timeout: 60
  - name: statsd
    release: graphite
    properties:
      statsd:
        deleteIdleStats: true
  - name: grafana
    release: grafana
    properties:
      grafana:
        root_url: /
        admin_username: admin
        admin_password: ((secrets_grafana_admin_password))
        datasources:
        - name: graphite
          type: graphite
          url: http://localhost:3001
  name: graphite
  networks:
  - name: cf
    static_ips:
    - 10.0.16.20
  persistent_disk_type: graphite_data
  stemcell: default
  vm_type: graphite
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: rds-broker
    release: rds-broker
    properties:
      rds-broker:
        password: ((secrets_rds_broker_admin_password))
        state_encryption_key: ((secrets_rds_broker_state_encryption_key))
        aws_access_key_id: ''
        aws_secret_access_key: ''
        aws_region: eu-west-1
        db_prefix: rdsbroker
        master_password_seed: ((secrets_rds_broker_master_password_seed))
        broker_name: ((terraform_outputs_environment))
        allow_user_provision_parameters: true
        allow_user_update_parameters: true
        catalog:
          services:
          - bindable: true
            description: AWS RDS PostgreSQL service
            id: ce71b484-d542-40f7-9dd4-5526e38c81ba
            metadata:
              displayName: AWS RDS Postgres
              documentationUrl: https://aws.amazon.com/documentation/rds/
              imageUrl: ''
              longDescription: AWS RDS postgres service
              providerDisplayName: Amazon Web Services
              supportUrl: https://forums.aws.amazon.com/forum.jspa?forumID=60
            name: postgres
            plan_updateable: true
            plans:
            - description: ! '5GB Storage, NOT BACKED UP, Dedicated Instance, Max
                50 Concurrent Connections. Postgres Version 9.5. DB Instance Class:
                db.t2.micro.'
              free: true
              id: 5f2eec8a-0cad-4ab9-b81e-d6adade2fd42
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
              name: Free
              rds_properties:
                allocated_storage: 5
                auto_minor_version_upgrade: true
                backup_retention_period: 0
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.micro
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: false
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: true
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance, Max 200 Concurrent
                Connections. Postgres Version 9.5. DB Instance Class: db.t2.small.'
              free: false
              id: b7d0a368-ac92-4eff-9b8d-ab4ba45bed0e
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.039
                  unit: HOUR
              name: S-dedicated-9.5
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: false
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance, Highly Available,
                Max 200 Concurrent Connections. Postgres Version 9.5. DB Instance
                Class: db.t2.small.'
              free: false
              id: 359bcb39-0264-46bd-9120-0182c3829067
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.078
                  unit: HOUR
              name: S-HA-dedicated-9.5
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance, Highly Available,
                Storage Encrypted, Max 200 Concurrent Connections. Postgres Version
                9.5. DB Instance Class: db.t2.small.'
              free: false
              id: d9f1d61d-0a65-45ad-8fc9-88c921d038d2
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.078
                  unit: HOUR
              name: S-HA-enc-dedicated-9.5
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance, Max 500 Concurrent
                Connections. Postgres Version 9.5. DB Instance Class: db.m4.large.'
              free: false
              id: 9b882524-ab58-4c18-b501-d2a3f4619104
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.201
                  unit: HOUR
              name: M-dedicated-9.5
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: false
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance, Highly Available,
                Max 500 Concurrent Connections. Postgres Version 9.5. DB Instance
                Class: db.m4.large.'
              free: false
              id: bf5b99c2-7990-4b66-b341-1bb83566d76e
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.402
                  unit: HOUR
              name: M-HA-dedicated-9.5
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance, Highly Available,
                Storage Encrypted, Max 500 Concurrent Connections. Postgres Version
                9.5. DB Instance Class: db.m4.large.'
              free: false
              id: 8d50ccc5-707c-4306-be8f-f59a158eb736
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 0.402
                  unit: HOUR
              name: M-HA-enc-dedicated-9.5
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance, Max 5000 Concurrent
                Connections. Postgres Version 9.5. DB Instance Class: db.m4.2xlarge.'
              free: false
              id: 238a1328-4f77-4b70-9bd9-2cdbbfb999c8
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.806
                  unit: HOUR
              name: L-dedicated-9.5
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: false
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance, Highly Available,
                Max 5000 Concurrent Connections. Postgres Version 9.5. DB Instance
                Class: db.m4.2xlarge.'
              free: false
              id: dfe4ab2b-2069-41a5-ba08-2be21b0c76d3
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 1.612
                  unit: HOUR
              name: L-HA-dedicated-9.5
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance, Highly Available,
                Storage Encrypted, Max 5000 Concurrent Connections. Postgres Version
                9.5. DB Instance Class: db.m4.2xlarge.'
              free: false
              id: 620055b3-fe7c-46fc-87ad-c7d8f4fe7f34
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 1.612
                  unit: HOUR
              name: L-HA-enc-dedicated-9.5
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance, Max 5000 Concurrent
                Connections. Postgres Version 9.5. DB Instance Class: db.m4.4xlarge.'
              free: false
              id: 1065c353-54dd-4f6b-a5b4-a4b5aa4575c6
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 1.612
                  unit: HOUR
              name: XL-dedicated-9.5
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: false
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance, Highly Available, Max
                5000 Concurrent Connections. Postgres Version 9.5. DB Instance Class:
                db.m4.4xlarge.'
              free: false
              id: 7119925f-518d-4263-96ac-16990295aad6
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - AWS RDS
                costs:
                - amount:
                    usd: 3.224
                  unit: HOUR
              name: XL-HA-dedicated-9.5
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance, Highly Available, Storage
                Encrypted, Max 5000 Concurrent Connections. Postgres Version 9.5.
                DB Instance Class: db.m4.4xlarge.'
              free: false
              id: a91c8e59-8869-42fd-8a99-8989151d7353
              metadata:
                bullets:
                - Dedicated Postgres 9.5 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 3.224
                  unit: HOUR
              name: XL-HA-enc-dedicated-9.5
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: postgres
                engine_version: '9.5'
                multi_az: true
                postgres_extensions:
                - uuid-ossp
                - postgis
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            tags:
            - postgres
            - relational
          - bindable: true
            description: AWS RDS MySQL service
            id: 4b888513-1dc3-4b9b-bdcd-51f4c03675a4
            metadata:
              displayName: AWS RDS MySQL
              documentationUrl: https://aws.amazon.com/documentation/rds/
              imageUrl: ''
              longDescription: AWS RDS MySQL service
              providerDisplayName: Amazon Web Services
              supportUrl: https://forums.aws.amazon.com/forum.jspa?forumID=60
            name: mysql
            plan_updateable: true
            plans:
            - description: ! '5GB Storage, NOT BACKED UP, Dedicated Instance. MySQL
                Version 5.7. DB Instance Class: db.t2.micro.'
              free: true
              id: 69977068-8ef5-4172-bfdb-e8cea3c14d01
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
              name: Free
              rds_properties:
                allocated_storage: 5
                auto_minor_version_upgrade: true
                backup_retention_period: 0
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.micro
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: false
                publicly_accessible: false
                skip_final_snapshot: true
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance. MySQL Version 5.7.
                DB Instance Class: db.t2.small.'
              free: false
              id: 7fdde6ea-cc27-466c-86aa-46181fc20d25
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.036
                  unit: HOUR
              name: S-dedicated-5.7
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: false
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance, Highly Available.
                MySQL Version 5.7. DB Instance Class: db.t2.small.'
              free: false
              id: 72279ebd-6001-4e38-aaef-72b68c4fa6fd
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.072
                  unit: HOUR
              name: S-HA-dedicated-5.7
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '20GB Storage, Dedicated Instance, Highly Available.
                Storage Encrypted. MySQL Version 5.7. DB Instance Class: db.t2.small.'
              free: false
              id: 6aa563c1-5aeb-46a1-9509-badcf5995c96
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.072
                  unit: HOUR
              name: S-HA-enc-dedicated-5.7
              rds_properties:
                allocated_storage: 20
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.t2.small
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance. MySQL Version 5.7.
                DB Instance Class: db.m4.large.'
              free: false
              id: 4eb35ca9-a7ec-46c6-b137-d819848536cd
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.193
                  unit: HOUR
              name: M-dedicated-5.7
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: false
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance, Highly Available.
                MySQL Version 5.7. DB Instance Class: db.m4.large.'
              free: false
              id: e60edf62-b701-4e38-846f-b0b3db728349
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.386
                  unit: HOUR
              name: M-HA-dedicated-5.7
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '100GB Storage, Dedicated Instance, Highly Available,
                Storage Encrypted. MySQL Version 5.7. DB Instance Class: db.m4.large.'
              free: false
              id: 8d139b9e-bc82-4749-8ad6-7733980292d6
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 0.386
                  unit: HOUR
              name: M-HA-enc-dedicated-5.7
              rds_properties:
                allocated_storage: 100
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.large
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance. MySQL Version 5.7.
                DB Instance Class: db.m4.2xlarge.'
              free: false
              id: 6725bf1f-71e8-447a-b6a1-659247fcc03c
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 0.772
                  unit: HOUR
              name: L-dedicated-5.7
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: false
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance, Highly Available.
                MySQL Version 5.7. DB Instance Class: db.m4.2xlarge.'
              free: false
              id: 63cdac92-9e44-42a6-ba3f-7be3dccf5dc6
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 1.544
                  unit: HOUR
              name: L-HA-dedicated-5.7
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '512GB Storage, Dedicated Instance, Highly Available,
                Storage Encrypted. MySQL Version 5.7. DB Instance Class: db.m4.2xlarge.'
              free: false
              id: d5efbf83-5e00-47a5-a668-2ef1307d5a23
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 1.544
                  unit: HOUR
              name: L-HA-enc-dedicated-5.7
              rds_properties:
                allocated_storage: 512
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.2xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance. MySQL Version 5.7.
                DB Instance Class: db.m4.4xlarge.'
              free: false
              id: a37144bf-4e05-451b-87ba-0a2c57a23a91
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 1.545
                  unit: HOUR
              name: XL-dedicated-5.7
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: false
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance, Highly Available. MySQL
                Version 5.7. DB Instance Class: db.m4.4xlarge.'
              free: false
              id: 065a7de5-28e8-4de1-8a39-4b4f752e2f2f
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - AWS RDS
                costs:
                - amount:
                    usd: 3.09
                  unit: HOUR
              name: XL-HA-dedicated-5.7
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: false
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            - description: ! '2TB Storage, Dedicated Instance, Highly Available, Storage
                Encrypted. MySQL Version 5.7. DB Instance Class: db.m4.4xlarge.'
              free: false
              id: 4edc975c-3f07-46f1-bd87-ecb35b76298f
              metadata:
                bullets:
                - Dedicated MySQL 5.7 server
                - Storage Encrypted
                - AWS RDS
                costs:
                - amount:
                    usd: 3.09
                  unit: HOUR
              name: XL-HA-enc-dedicated-5.7
              rds_properties:
                allocated_storage: 2048
                auto_minor_version_upgrade: true
                backup_retention_period: 7
                copy_tags_to_snapshot: true
                db_instance_class: db.m4.4xlarge
                db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
                db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
                engine: mysql
                engine_version: '5.7'
                multi_az: true
                publicly_accessible: false
                skip_final_snapshot: false
                storage_encrypted: true
                storage_type: gp2
                vpc_security_group_ids:
                - ((terraform_outputs_rds_broker_dbs_security_group_id))
            tags:
            - mysql
            - relational
  name: rds_broker
  networks:
  - name: cf
  stemcell: default
  vm_type: rds_broker
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: cdn-broker
    release: cdn-broker
    properties:
      cdn-broker:
        broker_username: cdn-broker
        broker_password: ((secrets_cdn_broker_admin_password))
        database_url: ((terraform_outputs_cdn_db_connection_string))
        email: the-multi-cloud-paas-team@digital.cabinet-office.gov.uk
        acme_url: https://acme-v01.api.letsencrypt.org/directory
        bucket: gds-paas-((environment))-cdn-broker-challenge
        iam_path_prefix: ((environment))-letsencrypt
        cloudfront_prefix: ((environment))-cdn
        aws_access_key_id: ''
        aws_secret_access_key: ''
        api_address: https://api.((terraform_outputs_cf_root_domain))
        client_id: cdn_broker
        client_secret: ((secrets_uaa_clients_cdn_broker_secret))
        default_origin: ((terraform_outputs_cf_apps_domain))
  - name: cdn-cron
    release: cdn-broker
    properties:
      cdn-broker:
        broker_username: cdn-broker
        broker_password: ((secrets_cdn_broker_admin_password))
        database_url: ((terraform_outputs_cdn_db_connection_string))
        email: the-multi-cloud-paas-team@digital.cabinet-office.gov.uk
        acme_url: https://acme-v01.api.letsencrypt.org/directory
        bucket: gds-paas-((environment))-cdn-broker-challenge
        iam_path_prefix: ((environment))-letsencrypt
        cloudfront_prefix: ((environment))-cdn
        aws_access_key_id: ''
        aws_secret_access_key: ''
        api_address: https://api.((terraform_outputs_cf_root_domain))
        client_id: cdn_broker
        client_secret: ((secrets_uaa_clients_cdn_broker_secret))
        default_origin: ((terraform_outputs_cf_apps_domain))
  - name: datadog-cdn-broker
    release: datadog-for-cloudfoundry
  name: cdn_broker
  networks:
  - name: cf
  stemcell: default
  vm_type: cdn_broker
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: elasticache-broker
    release: elasticache-broker
    properties:
      elasticache-broker:
        broker_name: elasticache-broker
        broker_username: elasticache-broker
        broker_password: ((secrets_elasticache_broker_admin_password))
        auth_token_seed: ((secrets_elasticache_broker_auth_token_seed))
        cache_subnet_group_name: ((terraform_outputs_elasticache_broker_subnet_group_name))
        vpc_security_group_ids:
        - ((terraform_outputs_elasticache_broker_instances_security_group_id))
        catalog:
          services:
          - bindable: true
            description: AWS ElastiCache Redis service
            id: 7b94ab02-478f-4c1b-95d8-21522672930b
            metadata:
              displayName: Redis
              documentationUrl: https://docs.cloud.service.gov.uk/#redis
              imageUrl: https://redis.io/images/redis-white.png
              longDescription: AWS ElastiCache Redis cluster
              providerDisplayName: GOV.UK PaaS
              supportUrl: https://www.cloud.service.gov.uk/support.html
            name: redis
            plan_updateable: true
            plans:
            - description: 568MB RAM, 1 shard, single node, no failover
              free: true
              id: 3a51701c-eef3-447c-882b-907ad2bcb7ab
              metadata:
                displayName: Redis Tiny
              name: tiny
            tags:
            - elasticache
            - redis
        plan_configs:
          3a51701c-eef3-447c-882b-907ad2bcb7ab:
            instance_type: cache.t2.micro
            parameters:
              maxmemory-policy: volatile-lru
              reserved-memory: '0'
            replicas_per_node_group: 0
            shard_count: 1
            snapshot_retention_limit: 7
        region: eu-west-1
  name: elasticache_broker
  networks:
  - name: cf
  stemcell: default
  vm_type: elasticache_broker
- azs:
  - z1
  - z2
  instances: 2
  jobs:
  - name: queue
    release: logsearch
  - name: datadog-logsearch-queue
    release: datadog-for-cloudfoundry
  name: queue
  networks:
  - name: cf
    static_ips: ((queue_static_ips))
  persistent_disk_type: queue
  release: logsearch
  stemcell: default
  vm_type: small
- azs:
  - z1
  instances: 1
  jobs:
  - name: parser
    release: logsearch
    properties:
      logstash_parser:
        filters: &9585540
        - logstash: /var/vcap/packages/logsearch-config-logstash-filters/logstash-filters-default.conf
        - custom-filters: /var/vcap/jobs/parser-config-lfc/config/logstash-filters-custom.conf
        elasticsearch:
          data_hosts:
          - ((terraform_outputs_logsearch_elastic_master_elb_dns_name))
      redis:
        host: ((queue_static_ips_first))
  - name: parser-config-lfc
    release: logsearch-for-cloudfoundry
    properties:
      logstash_parser:
        custom_filters: ! "if [garden][data][spec] == \"\" {\n  mutate {\n    remove_field
          => [ \"[garden][data][spec]\" ]\n  }\n}\nif [@source][component] == \"gorouter\"
          {\n  mutate { replace => { \"type\" => \"gorouter\" } }\n  grok {\n    match
          => {\n      \"@message\" =>\n        '%{HOSTNAME:[gorouter][host]} - \\[%{TIMESTAMP_ISO8601:[gorouter][timestamp]}\\]
          \"%{WORD:[gorouter][method]} %{URIPATHPARAM:[gorouter][request]} %{NOTSPACE:[gorouter][httpversion]}\"
          %{BASE10NUM:[gorouter][status]} %{BASE10NUM:[gorouter][bytesreceived]} %{BASE10NUM:[gorouter][bytessent]}
          %{QUOTEDSTRING:[gorouter][referer]} %{QUOTEDSTRING:[gorouter][useragent]}
          %{QUOTEDSTRING:[gorouter][clientaddr]} %{QUOTEDSTRING:[gorouter][upstreamaddr]}
          %{GREEDYDATA:routerkeys}'\n      }\n    tag_on_failure => [\"fail/cloudfoundry/gorouter/grok\"]\n
          \   add_tag => [\"gorouter\"]\n  }\n  kv {\n    source => \"router_keys\"\n
          \   target => \"[gorouter][header]\"\n    value_split => \":\"\n    remove_field
          => \"router_keys\"\n  }\n}\ndate {\n  match => [ \"[gorouter][timestamp]\",
          \"ISO8601\" ]\n  target => \"@timestamp\"\n}\nmutate {\n  remove_field =>
          [ \"[gorouter][timestamp]\" ]\n}\nif [@source][component] == \"vcap_nginx_access\"
          {\n  grok {\n    match => {\n      \"@message\" =>\n      '%{IPORHOST:[nginx][clientip]}
          - \\[%{HTTPDATE:[nginx][timestamp]}\\] \"%{WORD:[nginx][verb]} %{URIPATHPARAM:[nginx][request]}
          HTTP/%{NUMBER:[nginx][httpversion]}\" %{NUMBER:[nginx][response]} (?:%{NUMBER:[nginx][bytes]}|-)
          (?:\"(?:%{URI:[nginx][referrer]}|-)\"|%{QS:[nginx][referrer]}) %{QS:[nginx][agent]}
          %{DATA:[nginx][x_forwarded_for]} vcap_request_id:%{UUID:[nginx][vcap_request_id]}
          response_time:%{NUMBER:[nginx][response_time]}'\n      }\n  }\n}\ndate {\n
          \ match => [ \"[nginx][timestamp]\", \"dd/MMMM/yyyy:HH:mm:ss Z\", \"dd/MMM/yyyy:HH:mm:ss
          Z\", \"ISO8601\" ]\n  target => \"@timestamp\"\n}\nmutate {\n  remove_field
          => [ \"[nginx][timestamp]\" ]\n}\n\n# Remove unnecessary or empty fields\nmutate
          {\n  remove_field => [\n    \"syslog5424_ver\",\n    \"syslog_msgid\",\n
          \   \"syslog_procid\",\n    \"syslog_sd_id\",\n    \"syslog_sd_params\",\n
          \   \"[@source][director]\"\n  ]\n}\n"
  name: parser_z1
  networks:
  - name: cf
    static_ips:
    - 10.0.16.14
  release: logsearch
  stemcell: default
  vm_type: parser
- azs:
  - z2
  instances: 1
  jobs:
  - name: parser
    release: logsearch
    properties:
      logstash_parser:
        filters: *9585540
        elasticsearch:
          data_hosts:
          - ((terraform_outputs_logsearch_elastic_master_elb_dns_name))
      redis:
        host: ((queue_static_ips_second))
  - name: parser-config-lfc
    release: logsearch-for-cloudfoundry
    properties:
      logstash_parser:
        custom_filters: ! "if [garden][data][spec] == \"\" {\n  mutate {\n    remove_field
          => [ \"[garden][data][spec]\" ]\n  }\n}\nif [@source][component] == \"gorouter\"
          {\n  mutate { replace => { \"type\" => \"gorouter\" } }\n  grok {\n    match
          => {\n      \"@message\" =>\n        '%{HOSTNAME:[gorouter][host]} - \\[%{TIMESTAMP_ISO8601:[gorouter][timestamp]}\\]
          \"%{WORD:[gorouter][method]} %{URIPATHPARAM:[gorouter][request]} %{NOTSPACE:[gorouter][httpversion]}\"
          %{BASE10NUM:[gorouter][status]} %{BASE10NUM:[gorouter][bytesreceived]} %{BASE10NUM:[gorouter][bytessent]}
          %{QUOTEDSTRING:[gorouter][referer]} %{QUOTEDSTRING:[gorouter][useragent]}
          %{QUOTEDSTRING:[gorouter][clientaddr]} %{QUOTEDSTRING:[gorouter][upstreamaddr]}
          %{GREEDYDATA:routerkeys}'\n      }\n    tag_on_failure => [\"fail/cloudfoundry/gorouter/grok\"]\n
          \   add_tag => [\"gorouter\"]\n  }\n  kv {\n    source => \"router_keys\"\n
          \   target => \"[gorouter][header]\"\n    value_split => \":\"\n    remove_field
          => \"router_keys\"\n  }\n}\ndate {\n  match => [ \"[gorouter][timestamp]\",
          \"ISO8601\" ]\n  target => \"@timestamp\"\n}\nmutate {\n  remove_field =>
          [ \"[gorouter][timestamp]\" ]\n}\nif [@source][component] == \"vcap_nginx_access\"
          {\n  grok {\n    match => {\n      \"@message\" =>\n      '%{IPORHOST:[nginx][clientip]}
          - \\[%{HTTPDATE:[nginx][timestamp]}\\] \"%{WORD:[nginx][verb]} %{URIPATHPARAM:[nginx][request]}
          HTTP/%{NUMBER:[nginx][httpversion]}\" %{NUMBER:[nginx][response]} (?:%{NUMBER:[nginx][bytes]}|-)
          (?:\"(?:%{URI:[nginx][referrer]}|-)\"|%{QS:[nginx][referrer]}) %{QS:[nginx][agent]}
          %{DATA:[nginx][x_forwarded_for]} vcap_request_id:%{UUID:[nginx][vcap_request_id]}
          response_time:%{NUMBER:[nginx][response_time]}'\n      }\n  }\n}\ndate {\n
          \ match => [ \"[nginx][timestamp]\", \"dd/MMMM/yyyy:HH:mm:ss Z\", \"dd/MMM/yyyy:HH:mm:ss
          Z\", \"ISO8601\" ]\n  target => \"@timestamp\"\n}\nmutate {\n  remove_field
          => [ \"[nginx][timestamp]\" ]\n}\n\n# Remove unnecessary or empty fields\nmutate
          {\n  remove_field => [\n    \"syslog5424_ver\",\n    \"syslog_msgid\",\n
          \   \"syslog_procid\",\n    \"syslog_sd_id\",\n    \"syslog_sd_params\",\n
          \   \"[@source][director]\"\n  ]\n}\n"
  name: parser_z2
  networks:
  - name: cf
    static_ips:
    - 10.0.17.14
  release: logsearch
  stemcell: default
  vm_type: parser
- azs:
  - z1
  - z2
  - z3
  instances: 3
  jobs:
  - name: elasticsearch
    release: logsearch
    properties:
      elasticsearch:
        master_hosts: ((elasticsearch_master_static_ips))
        cluster_name: logsearch
        node:
          allow_master: true
          allow_data: true
        discovery:
          minimum_master_nodes: 2
        health:
          disable_post_start: true
  name: elasticsearch_master
  networks:
  - name: cf
    static_ips: ((elasticsearch_master_static_ips))
  persistent_disk_type: elasticsearch_master
  release: logsearch
  stemcell: default
  update:
    canaries: 0
    max_in_flight: 3
    serial: true
  vm_type: elasticsearch_master
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: elasticsearch_config
    release: logsearch
    properties:
      elasticsearch_config:
        elasticsearch:
          host: ((terraform_outputs_logsearch_elastic_master_elb_dns_name))
        templates:
        - shards-and-replicas: /var/vcap/jobs/elasticsearch_config/index-templates/shards-and-replicas.json
        - index-settings: /var/vcap/jobs/elasticsearch_config/index-templates/index-settings.json
        - index-mappings-lfc: /var/vcap/jobs/elasticsearch-config-lfc/index-mappings.json
  - name: curator
    release: logsearch
    properties:
      curator:
        elasticsearch:
          host: ((terraform_outputs_logsearch_elastic_master_elb_dns_name))
        purge_logs:
          retention_period: 30
  - name: elasticsearch-config-lfc
    release: logsearch-for-cloudfoundry
  name: maintenance
  networks:
  - name: cf
  release: logsearch
  stemcell: default
  vm_type: small
- azs:
  - z1
  - z2
  instances: 1
  jobs:
  - name: kibana
    release: logsearch
    properties:
      kibana:
        elasticsearch:
          host: ((terraform_outputs_logsearch_elastic_master_elb_dns_name))
          port: 9200
        request_timeout: 300000
        shard_timeout: 30000
  - name: haproxy
    release: logsearch
    properties:
      haproxy:
        kibana:
          inbound_port: 5602
          backend_servers:
          - localhost
          backend_port: 5601
          auth:
            username: admin
            password: ((secrets_kibana_admin_password))
  name: kibana
  networks:
  - name: cf
  release: logsearch
  stemcell: default
  vm_type: kibana
- azs:
  - z1
  instances: 1
  jobs:
  - name: ingestor_syslog
    release: logsearch
    properties:
      redis:
        host: ((queue_static_ips_first))
  name: ingestor_z1
  networks:
  - default:
    - gateway
    - dns
    name: cf
    static_ips:
    - 10.0.16.12
  release: logsearch
  stemcell: default
  update:
    serial: true
  vm_type: ingestor
- azs:
  - z2
  instances: 1
  jobs:
  - name: ingestor_syslog
    release: logsearch
    properties:
      redis:
        host: ((queue_static_ips_second))
  name: ingestor_z2
  networks:
  - default:
    - gateway
    - dns
    name: cf
    static_ips:
    - 10.0.17.12
  release: logsearch
  stemcell: default
  update:
    serial: true
  vm_type: ingestor
meta:
  environment: ((terraform_outputs_environment))
  rds_broker:
    default_mysql_rds_properties:
      auto_minor_version_upgrade: true
      backup_retention_period: 7
      copy_tags_to_snapshot: true
      db_parameter_group_name: ((terraform_outputs_rds_broker_mysql57_db_parameter_group))
      db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
      engine: mysql
      engine_version: '5.7'
      multi_az: false
      publicly_accessible: false
      skip_final_snapshot: false
      storage_encrypted: false
      storage_type: gp2
      vpc_security_group_ids:
      - ((terraform_outputs_rds_broker_dbs_security_group_id))
    default_postgres_rds_properties:
      auto_minor_version_upgrade: true
      backup_retention_period: 7
      copy_tags_to_snapshot: true
      db_parameter_group_name: ((terraform_outputs_rds_broker_postgres95_db_parameter_group))
      db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
      engine: postgres
      engine_version: '9.5'
      multi_az: false
      postgres_extensions:
      - uuid-ossp
      - postgis
      publicly_accessible: false
      skip_final_snapshot: false
      storage_encrypted: false
      storage_type: gp2
      vpc_security_group_ids:
      - ((terraform_outputs_rds_broker_dbs_security_group_id))
    default_rds_properties:
      auto_minor_version_upgrade: true
      backup_retention_period: 7
      copy_tags_to_snapshot: true
      db_subnet_group_name: ((terraform_outputs_rds_broker_dbs_subnet_group))
      multi_az: false
      publicly_accessible: false
      skip_final_snapshot: false
      storage_encrypted: false
      storage_type: gp2
      vpc_security_group_ids:
      - ((terraform_outputs_rds_broker_dbs_security_group_id))
    free_plan_rds_properties:
      allocated_storage: 5
      backup_retention_period: 0
      db_instance_class: db.t2.micro
      skip_final_snapshot: true
    large_plan_rds_properties:
      allocated_storage: 512
      db_instance_class: db.m4.2xlarge
    medium_plan_rds_properties:
      allocated_storage: 100
      db_instance_class: db.m4.large
    small_plan_rds_properties:
      allocated_storage: 20
      db_instance_class: db.t2.small
    xlarge_plan_rds_properties:
      allocated_storage: 2048
      db_instance_class: db.m4.4xlarge
name: ((environment))
releases:
- name: consul
  sha1: 61b429ae13e0fde0ebdb98fce99e08f7baf60a16
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/consul-release?v=191
  version: '191'
- name: nats
  sha1: 1300071c7cf43f5d299a6eaec6f6bb6cca7eac3b
  url: https://bosh.io/d/github.com/cloudfoundry/nats-release?v=22
  version: '22'
- name: uaa
  sha1: 393d844138f7b32017d7706684c36bf499e8cc79
  url: https://bosh.io/d/github.com/cloudfoundry/uaa-release?v=55
  version: '55'
- name: statsd-injector
  sha1: f995b553969a73d717cf42e7d240f4e899efd8ac
  url: https://bosh.io/d/github.com/cloudfoundry/statsd-injector-release?v=1.2.0
  version: 1.2.0
- name: routing
  sha1: fa6b0966e38b4089e0565fcab8bf09035ab43778
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/cf-routing-release?v=0.172.0
  version: 0.172.0
- name: capi
  sha1: da59f9232a828e364337b81952a5510d8f1ca3b9
  url: https://bosh.io/d/github.com/cloudfoundry/capi-release?v=1.49.0
  version: 1.49.0
- name: diego
  sha1: 7525f412d6698f499124f0facee64a40a1e99ec0
  url: https://bosh.io/d/github.com/cloudfoundry/diego-release?v=1.35.0
  version: 1.35.0
- name: garden-runc
  sha1: d9a7901c0502d97c043b857496f0f414a5843e8d
  url: https://bosh.io/d/github.com/cloudfoundry/garden-runc-release?v=1.11.1
  version: 1.11.1
- name: cflinuxfs2
  sha1: dd38c18449d3119d42ad1ab7bba589e6da9e1a7c
  url: https://bosh.io/d/github.com/cloudfoundry/cflinuxfs2-release?v=1.187.0
  version: 1.187.0
- name: paas-haproxy
  sha1: c8c90a4c14ea2201a37469596b5cef309864a394
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/paas-haproxy-0.1.5.tgz
  version: 0.1.5
- name: datadog-for-cloudfoundry
  sha1: 6f900dacfbd2dc7e684435de9577ea63e7cdb174
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/datadog-for-cloudfoundry-0.0.1520264538.tgz
  version: 0.0.1520264538
- name: ipsec
  sha1: 6a9e252162519e50f6c511c489ba304a286d496a
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/ipsec-0.1.3.tgz
  version: 0.1.3
- name: loggregator
  sha1: f83ca26da62276e4e8247e32dbfbf2ae1a4c6138
  url: https://bosh.io/d/github.com/cloudfoundry/loggregator-release?v=101.6
  version: '101.6'
- name: cf-syslog-drain
  sha1: ccc588acc4854d669f60ad1c826d2b366e3548c6
  url: https://bosh.io/d/github.com/cloudfoundry/cf-syslog-drain-release?v=5.1
  version: '5.1'
- name: binary-buildpack
  sha1: d8d7db55c1602a8587ed681e714a4d121a813a36
  url: https://bosh.io/d/github.com/cloudfoundry/binary-buildpack-release?v=1.0.16
  version: 1.0.16
- name: go-buildpack
  sha1: a5e35c37446271cd1294785057fe3fb16bc643e9
  url: https://bosh.io/d/github.com/cloudfoundry/go-buildpack-release?v=1.8.18
  version: 1.8.18
- name: java-buildpack
  sha1: c5ad741533275c1b9ae6a844dda5d0ae14669add
  url: https://bosh.io/d/github.com/cloudfoundry/java-buildpack-release?v=4.8
  version: '4.8'
- name: nodejs-buildpack
  sha1: 5759e23cc03bfe6918a10420900a945063596ea8
  url: https://bosh.io/d/github.com/cloudfoundry/nodejs-buildpack-release?v=1.6.16
  version: 1.6.16
- name: php-buildpack
  sha1: 76192602e33b77df2822d47f0da10da93071d6ee
  url: https://bosh.io/d/github.com/cloudfoundry/php-buildpack-release?v=4.3.48
  version: 4.3.48
- name: python-buildpack
  sha1: e45487dd74f714c3d6b49ca5155cc74c958e22df
  url: https://bosh.io/d/github.com/cloudfoundry/python-buildpack-release?v=1.6.8
  version: 1.6.8
- name: ruby-buildpack
  sha1: e26b5f179473d03091de1fa8c6cab7ddab2edd4f
  url: https://bosh.io/d/github.com/cloudfoundry/ruby-buildpack-release?v=1.7.11
  version: 1.7.11
- name: staticfile-buildpack
  sha1: 0629f6cc368475e914f9219d3f87d78b820c3b00
  url: https://bosh.io/d/github.com/cloudfoundry/staticfile-buildpack-release?v=1.4.21
  version: 1.4.21
- name: graphite
  sha1: 7ce15711ae9afc04ccf152bab3f7de9b234f7c4f
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/graphite-0.1.1.tgz
  version: 0.1.1
- name: grafana
  sha1: 483ee4a07d683c94014efede103dd93cb92cd883
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/grafana-0.1.2.tgz
  version: 0.1.2
- name: rds-broker
  sha1: 8f52931dd63f2ac7e0335b2269633edfba40e3eb
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/rds-broker-0.1.21.tgz
  version: 0.1.21
- name: cdn-broker
  sha1: 7db1bf1d80707e56d257d813d5155ce3c6767127
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/cdn-broker-0.1.6.tgz
  version: 0.1.6
- name: elasticache-broker
  sha1: 189898fb860b5f51ac62dd74d5d2e0b1ad7c94f6
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/elasticache-broker-0.1.5.tgz
  version: 0.1.5
- name: logsearch
  sha1: 96d0249797be68d47027cf3cda904a4eaee5aa1f
  url: https://bosh.io/d/github.com/cloudfoundry-community/logsearch-boshrelease?v=205.0.1
  version: 205.0.1
- name: logsearch-for-cloudfoundry
  sha1: 7b450ea1ed91fe434eadd667f393f5d877321f1f
  url: https://s3-eu-west-1.amazonaws.com/gds-paas-build-releases/logsearch-for-cloudfoundry-0.1.4.tgz
  version: 0.1.4
stemcells:
- alias: default
  name: bosh-aws-xen-hvm-ubuntu-trusty-go_agent
  version: '3468.25'
update:
  canaries: 0
  canary_watch_time: 30000-420000
  max_in_flight: 1
  serial: false
  update_watch_time: 5000-420000
